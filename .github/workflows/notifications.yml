# ==============================================
# Pull Request Notifications
# ==============================================
# Sends Telegram notifications for PR events

name: Notifications

on:
  pull_request:
    types: [opened, closed]
    branches: [main, master]

permissions:
  contents: read
  pull-requests: read

jobs:
  # ==============================================
  # PR Opened Notification
  # ==============================================
  notify-pr-opened:
    name: Notify PR Opened
    runs-on: ubuntu-latest
    if: github.event.action == 'opened'
    steps:
      - name: Send Telegram notification
        run: |
          curl -X POST "${{ secrets.TELEGRAM_API_URL }}" \
            -H "Content-Type: application/json" \
            -d '{
              "message": {
                "text": "🚀 New Pull Request Opened\n\n📝 Title: ${{ github.event.pull_request.title }}\n👤 Author: ${{ github.event.pull_request.user.login }}\n🌿 Branch: `${{ github.event.pull_request.head.ref }}` → `${{ github.event.pull_request.base.ref }}`\n🔗 Link: ${{ github.event.pull_request.html_url }}\n📊 Repository: ${{ github.repository }}"
              }
            }'

  # ==============================================
  # PR Merged Notification
  # ==============================================
  notify-pr-merged:
    name: Notify PR Merged
    runs-on: ubuntu-latest
    if: github.event.action == 'closed' && github.event.pull_request.merged == true
    steps:
      - name: Send Telegram notification
        run: |
          curl -X POST "${{ secrets.TELEGRAM_API_URL }}" \
            -H "Content-Type: application/json" \
            -d '{
              "message": {
                "text": "✅ Pull Request Merged\n\n📝 Title: ${{ github.event.pull_request.title }}\n👤 Author: ${{ github.event.pull_request.user.login }}\n🌿 Branch: `${{ github.event.pull_request.head.ref }}` → `${{ github.event.pull_request.base.ref }}`\n🔗 Link: ${{ github.event.pull_request.html_url }}\n📊 Repository: ${{ github.repository }}"
              }
            }'